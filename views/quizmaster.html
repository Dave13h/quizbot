<!doctype html>
<html>
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />

        <title>Quiz Master</title>

        <link href="css/nes.min.css" rel="stylesheet" />
        <link href="css/animate.css" rel="stylesheet" />
        <link href="css/style.css" rel="stylesheet" />
    </head>
    <body>
        <h1>Quiz Master</h1>

        <section class="container with-title">
            <h2 class="title">Connections</h2>
            <div class="containers" id="connections">

            </div>
        </section>

        <script src="/socket.io/socket.io.js"></script>
        <script src="https://code.jquery.com/jquery-1.11.1.js"></script>
        <script>
          $(function () {
                var socket = io.connect('/quizmaster'),
                    qmid   = window.localStorage.getItem('qmid');

                socket.on('connections list', function(connections){
                    $('#connections').html('');
                    if (connections.length == 0) {
                        $('#connections').append("-- No Connections --");
                        return;
                    }
                    $(connections).each(function(k, v) {
                        $('#connections').append(v + "<br/>");
                    });
                });

                socket
                .on('reconnect', function(msg) {
                    socket.emit('ident', qmid);
                    console.log("Reconnected");
                })
                .on('connect', function(msg) {
                    socket.emit('ident', qmid);
                    console.log("Connected");
                })
                .on('id', function(id){
                    console.log('Got ID: ' + id);
                    qmid = id;
                    window.localStorage.setItem('qmid', qmid);
                });
            });
        </script>
    </body>
</html>
